# ç®¡ç†å‘˜è´¦å·é…ç½®æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜äº†åœ¨ä¸åŒå­˜å‚¨æ¨¡å¼ä¸‹å¦‚ä½•é…ç½®å’Œç®¡ç†ç®¡ç†å‘˜è´¦å·ã€‚

## ğŸ”‘ å­˜å‚¨æ¨¡å¼å¯¹æ¯”

| å­˜å‚¨æ¨¡å¼ | é»˜è®¤è´¦å· | ç¯å¢ƒå˜é‡æ”¯æŒ | é…ç½®æ–¹å¼ |
|---------|---------|------------|---------|
| **localStorage** | admin / 123789 | âœ… æ”¯æŒ | ç¯å¢ƒå˜é‡æˆ–é»˜è®¤è´¦å· |
| **D1 æ•°æ®åº“** | admin / admin123 (SQL) | âœ… æ”¯æŒ | ç¯å¢ƒå˜é‡ä¼˜å…ˆï¼ŒSQLé»˜è®¤ |

---

## ğŸ¯ localStorage æ¨¡å¼

### é»˜è®¤ç®¡ç†å‘˜è´¦å·

å¦‚æœæœªé…ç½®ç¯å¢ƒå˜é‡ï¼Œç³»ç»Ÿä½¿ç”¨ä»¥ä¸‹é»˜è®¤è´¦å·ï¼š

```
ç”¨æˆ·å: admin
å¯†ç : 123789
```

### é€šè¿‡ç¯å¢ƒå˜é‡è‡ªå®šä¹‰

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `.env.local` æ–‡ä»¶ï¼š

```bash
ADMIN_USERNAME=your_username
ADMIN_PASSWORD=your_password
```

æˆ–åœ¨éƒ¨ç½²å¹³å°ï¼ˆå¦‚ Vercelï¼‰è®¾ç½®ç¯å¢ƒå˜é‡ï¼š

| å˜é‡å | ç¤ºä¾‹å€¼ | è¯´æ˜ |
|--------|--------|------|
| `ADMIN_USERNAME` | `myAdmin` | è‡ªå®šä¹‰ç®¡ç†å‘˜ç”¨æˆ·å |
| `ADMIN_PASSWORD` | `MySecurePass123!` | è‡ªå®šä¹‰ç®¡ç†å‘˜å¯†ç  |

### ç™»å½•é€»è¾‘

```typescript
// src/app/api/auth/login/route.ts
const Username = process.env.USERNAME || 'admin';
const Password = process.env.PASSWORD || '123789';

if (username === Username && password === Password) {
  // ç™»å½•æˆåŠŸ
}
```

---

## ğŸ—„ï¸ D1 æ•°æ®åº“æ¨¡å¼

### è´¦å·ä¼˜å…ˆçº§

D1 æ¨¡å¼ä¸‹çš„ç®¡ç†å‘˜è´¦å·æŒ‰ä»¥ä¸‹ä¼˜å…ˆçº§å¤„ç†ï¼š

1. **ç¯å¢ƒå˜é‡é…ç½®** (æœ€é«˜ä¼˜å…ˆçº§)
2. **SQL é»˜è®¤è´¦å·** (d1-init.sql)

### æ–¹å¼ä¸€ï¼šé€šè¿‡ç¯å¢ƒå˜é‡é…ç½®ï¼ˆæ¨èï¼‰

åœ¨ Cloudflare Pages é¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ç¯å¢ƒå˜é‡ï¼š

| å˜é‡å | ç¤ºä¾‹å€¼ | è¯´æ˜ |
|--------|--------|------|
| `USERNAME` | `superadmin` | ç®¡ç†å‘˜ç”¨æˆ·å |
| `PASSWORD` | `SecurePass2024!` | ç®¡ç†å‘˜å¯†ç  |

**å·¥ä½œåŸç†ï¼š**

```typescript
// src/lib/d1.storage.ts - initializeAdminUser()
const Username = process.env.USERNAME;
const Password = process.env.PASSWORD;

// æ£€æŸ¥ç®¡ç†å‘˜æ˜¯å¦å·²å­˜åœ¨
const existing = await this.getUserByUsername(Username);

if (!existing) {
  // åˆ›å»ºæ–°çš„ç®¡ç†å‘˜è´¦å·
  await this.createUser(Username, Password, 'admin');
}
```

**åˆå§‹åŒ–æ—¶æœºï¼š**
- é¦–æ¬¡è®¿é—® API æ—¶è‡ªåŠ¨æ‰§è¡Œ
- åœ¨ `initializeWithStaticData()` æ–¹æ³•ä¸­è°ƒç”¨
- åªåˆ›å»ºä¸€æ¬¡ï¼Œä¸ä¼šé‡å¤åˆ›å»º

### æ–¹å¼äºŒï¼šä½¿ç”¨ SQL é»˜è®¤è´¦å·

å¦‚æœæœªè®¾ç½®ç¯å¢ƒå˜é‡ï¼Œç³»ç»Ÿä½¿ç”¨ `d1-init.sql` ä¸­çš„é»˜è®¤è´¦å·ï¼š

```sql
-- d1-init.sql
INSERT OR IGNORE INTO users (username, password, role) 
VALUES ('admin', 'admin123', 'admin');
```

```
ç”¨æˆ·å: admin
å¯†ç : admin123
```

âš ï¸ **å®‰å…¨è­¦å‘Š**ï¼šç”Ÿäº§ç¯å¢ƒä¸­ä¸å»ºè®®ä½¿ç”¨ SQL é»˜è®¤è´¦å·ï¼

---

## ğŸš€ éƒ¨ç½²é…ç½®æ­¥éª¤

### Cloudflare Pages éƒ¨ç½²

#### æ­¥éª¤ 1ï¼šåˆ›å»º D1 æ•°æ®åº“

```bash
# åœ¨ Cloudflare Dashboard ä¸­åˆ›å»º D1 æ•°æ®åº“
åç§°: ai-prompts-db
```

#### æ­¥éª¤ 2ï¼šåˆå§‹åŒ–æ•°æ®åº“

åœ¨ D1 æ§åˆ¶å°æ‰§è¡Œ `d1-init.sql` è„šæœ¬ã€‚

#### æ­¥éª¤ 3ï¼šç»‘å®š D1 æ•°æ®åº“

```
è®¾ç½® â†’ ç»‘å®š â†’ D1 æ•°æ®åº“
å˜é‡åç§°: DB
D1 æ•°æ®åº“: ai-prompts-db
```

#### æ­¥éª¤ 4ï¼šé…ç½®ç¯å¢ƒå˜é‡

```
è®¾ç½® â†’ ç¯å¢ƒå˜é‡
```

**å¿…éœ€å˜é‡ï¼š**

| å˜é‡å | å€¼ |
|--------|-----|
| `NEXT_PUBLIC_STORAGE_TYPE` | `d1` |

**æ¨èå˜é‡ï¼ˆç®¡ç†å‘˜è´¦å·ï¼‰ï¼š**

| å˜é‡å | å€¼ | å¤‡æ³¨ |
|--------|-----|------|
| `USERNAME` | `admin` | è‡ªå®šä¹‰ç®¡ç†å‘˜ç”¨æˆ·å |
| `PASSWORD` | `` | å¼ºå¯†ç  |

#### æ­¥éª¤ 5ï¼šé‡æ–°éƒ¨ç½²

ä¿å­˜é…ç½®åè§¦å‘é‡æ–°éƒ¨ç½²ã€‚

---

## ğŸ” å®‰å…¨æœ€ä½³å®è·µ

### 1. å¼ºå¯†ç ç­–ç•¥

ç®¡ç†å‘˜å¯†ç åº”æ»¡è¶³ï¼š
- âœ… è‡³å°‘ 12 ä¸ªå­—ç¬¦
- âœ… åŒ…å«å¤§å†™å­—æ¯ (A-Z)
- âœ… åŒ…å«å°å†™å­—æ¯ (a-z)
- âœ… åŒ…å«æ•°å­— (0-9)
- âœ… åŒ…å«ç‰¹æ®Šå­—ç¬¦ (!@#$%^&*)

**ç¤ºä¾‹å¼ºå¯†ç ï¼š**
```
MySecure@Admin2024!
P@ssw0rd#Secure123
Admin$Strong2024!
```

### 2. ç¯å¢ƒå˜é‡é…ç½®

âœ… **æ¨èåšæ³•ï¼š**
- åœ¨ Cloudflare Pages è®¾ç½®ä¸­é…ç½®ç¯å¢ƒå˜é‡
- ä½¿ç”¨ä¸åŒçš„ç”Ÿäº§å’Œå¼€å‘ç¯å¢ƒè´¦å·
- å®šæœŸæ›´æ¢å¯†ç 

âŒ **é¿å…åšæ³•ï¼š**
- åœ¨ä»£ç ä¸­ç¡¬ç¼–ç å¯†ç 
- å°† `.env` æ–‡ä»¶æäº¤åˆ° Git
- ä½¿ç”¨ç®€å•å¯†ç ï¼ˆå¦‚ admin123ï¼‰

### 3. ç”Ÿäº§ç¯å¢ƒæ£€æŸ¥æ¸…å•

- [ ] å·²è®¾ç½® `ADMIN_USERNAME` ç¯å¢ƒå˜é‡
- [ ] å·²è®¾ç½® `ADMIN_PASSWORD` ç¯å¢ƒå˜é‡ï¼ˆå¼ºå¯†ç ï¼‰
- [ ] å·²åˆ é™¤æˆ–ç¦ç”¨ SQL é»˜è®¤è´¦å·
- [ ] å·²å¯ç”¨ HTTPS
- [ ] å·²é…ç½® D1 æ•°æ®åº“å¤‡ä»½
- [ ] å·²æµ‹è¯•ç®¡ç†å‘˜ç™»å½•åŠŸèƒ½

---

## ğŸ” æ•…éšœæ’æŸ¥

### é—®é¢˜ 1ï¼šæ— æ³•ä½¿ç”¨ç¯å¢ƒå˜é‡ç™»å½•

**ç—‡çŠ¶ï¼š**
è®¾ç½®äº† `ADMIN_USERNAME` å’Œ `ADMIN_PASSWORD`ï¼Œä½†æ— æ³•ç™»å½•ã€‚

**åŸå› ï¼š**
- ç¯å¢ƒå˜é‡æœªç”Ÿæ•ˆï¼ˆéœ€è¦é‡æ–°éƒ¨ç½²ï¼‰
- å˜é‡åæ‹¼å†™é”™è¯¯
- D1 æ¨¡å¼ä¸‹è´¦å·æœªè‡ªåŠ¨åˆ›å»º

**è§£å†³æ–¹æ¡ˆï¼š**

1. æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®ï¼š
```bash
# åœ¨ Cloudflare Pages è®¾ç½®ä¸­ç¡®è®¤
ADMIN_USERNAME=your_username âœ…
ADMIN_PASSWORD=your_password âœ…
```

2. é‡æ–°éƒ¨ç½²é¡¹ç›®ï¼š
```
Cloudflare Pages â†’ éƒ¨ç½² â†’ é‡æ–°éƒ¨ç½²
```

3. æŸ¥çœ‹éƒ¨ç½²æ—¥å¿—ï¼š
```
æŸ¥æ‰¾æ—¥å¿—ä¸­çš„æ¶ˆæ¯ï¼š
"Admin user 'your_username' created successfully from environment variables"
```

### é—®é¢˜ 2ï¼šD1 æ¨¡å¼ä¸‹ä½¿ç”¨é»˜è®¤è´¦å·æ— æ³•ç™»å½•

**ç—‡çŠ¶ï¼š**
ä½¿ç”¨ admin/admin123 æ— æ³•ç™»å½•ã€‚

**åŸå› ï¼š**
- æœªæ‰§è¡Œ `d1-init.sql` åˆå§‹åŒ–è„šæœ¬
- æ•°æ®åº“ç»‘å®šé…ç½®é”™è¯¯

**è§£å†³æ–¹æ¡ˆï¼š**

1. æ£€æŸ¥æ•°æ®åº“åˆå§‹åŒ–ï¼š
```sql
-- åœ¨ D1 æ§åˆ¶å°æ‰§è¡Œ
SELECT * FROM users WHERE role = 'admin';
```

2. å¦‚æœæ²¡æœ‰è®°å½•ï¼Œæ‰§è¡Œï¼š
```sql
INSERT INTO users (username, password, role) 
VALUES ('admin', 'admin123', 'admin');
```

### é—®é¢˜ 3ï¼šlocalStorage æ¨¡å¼ä¸‹é»˜è®¤è´¦å·ä¸å·¥ä½œ

**ç—‡çŠ¶ï¼š**
ä½¿ç”¨ admin/123789 æ— æ³•ç™»å½•ã€‚

**åŸå› ï¼š**
- ä»£ç ç‰ˆæœ¬è¿‡æ—§
- ç¯å¢ƒå˜é‡é…ç½®å†²çª

**è§£å†³æ–¹æ¡ˆï¼š**

1. ç¡®è®¤ä»£ç ç‰ˆæœ¬ï¼š
```typescript
// src/app/api/auth/login/route.ts
const adminUsername = process.env.ADMIN_USERNAME || 'admin';
const adminPassword = process.env.ADMIN_PASSWORD || '123789';
```

2. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜å¹¶é‡è¯•

---

## ğŸ“Š è´¦å·ç®¡ç†æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç”¨æˆ·ç™»å½•è¯·æ±‚                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  æ£€æŸ¥å­˜å‚¨æ¨¡å¼         â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                               â”‚
         â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ localStorage    â”‚            â”‚  D1 æ•°æ®åº“      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                               â”‚
         â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¯å¢ƒå˜é‡å­˜åœ¨ï¼Ÿ   â”‚            â”‚ æŸ¥è¯¢æ•°æ®åº“      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                               â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚æ˜¯       â”‚å¦                  â”‚æ‰¾åˆ°     â”‚æœªæ‰¾åˆ°
    â–¼         â–¼                    â–¼         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ç¯å¢ƒå˜é‡â”‚ â”‚é»˜è®¤è´¦å·â”‚        â”‚éªŒè¯å¯†ç â”‚ â”‚ç™»å½•å¤±è´¥â”‚
â”‚éªŒè¯    â”‚ â”‚admin/  â”‚        â”‚        â”‚ â”‚        â”‚
â”‚        â”‚ â”‚123789  â”‚        â”‚        â”‚ â”‚        â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚         â”‚                 â”‚
     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                 â”‚
          â–¼                      â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ç™»å½•æˆåŠŸ â”‚          â”‚ ç™»å½•æˆåŠŸ â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ ä»£ç å®ç°å‚è€ƒ

### localStorage æ¨¡å¼ç™»å½•

```typescript
// src/app/api/auth/login/route.ts
if (STORAGE_TYPE === 'localstorage') {
  const adminUsername = process.env.ADMIN_USERNAME || 'admin';
  const adminPassword = process.env.ADMIN_PASSWORD || '123789';

  if (username === adminUsername && password === adminPassword) {
    return NextResponse.json({
      success: true,
      user: {
        id: 0,
        username: adminUsername,
        role: 'admin',
        avatar: null
      }
    });
  }
}
```

### D1 æ¨¡å¼ç®¡ç†å‘˜åˆå§‹åŒ–

```typescript
// src/lib/d1.storage.ts
async initializeAdminUser(): Promise<void> {
  const adminUsername = process.env.ADMIN_USERNAME || process.env.USERNAME;
  const adminPassword = process.env.ADMIN_PASSWORD || process.env.PASSWORD;

  if (!adminUsername || !adminPassword) {
    console.log('No admin credentials in environment variables');
    return;
  }

  const existingAdmin = await this.getUserByUsername(adminUsername);
  
  if (!existingAdmin) {
    await this.createUser(adminUsername, adminPassword, 'admin');
    console.log(`Admin user '${adminUsername}' created successfully`);
  }
}
```

---

## ğŸ¯ å¿«é€Ÿå‚è€ƒ

### localStorage æ¨¡å¼

| åœºæ™¯ | ç”¨æˆ·å | å¯†ç  | é…ç½®æ–¹å¼ |
|------|--------|------|---------|
| é»˜è®¤ | admin | 123789 | æ— éœ€é…ç½® |
| è‡ªå®šä¹‰ | ç¯å¢ƒå˜é‡ | ç¯å¢ƒå˜é‡ | ADMIN_USERNAME + ADMIN_PASSWORD |

### D1 æ•°æ®åº“æ¨¡å¼

| åœºæ™¯ | ç”¨æˆ·å | å¯†ç  | é…ç½®æ–¹å¼ |
|------|--------|------|---------|
| ç¯å¢ƒå˜é‡ï¼ˆæ¨èï¼‰ | è‡ªå®šä¹‰ | è‡ªå®šä¹‰ | ADMIN_USERNAME + ADMIN_PASSWORD |
| SQL é»˜è®¤ | admin | admin123 | d1-init.sql |

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [D1 éƒ¨ç½²æŒ‡å—](./D1_DEPLOY_GUIDE.md)
- [å¿«é€Ÿå¼€å§‹](./QUICK_START.md)
- [Cloudflare D1 æ–‡æ¡£](https://developers.cloudflare.com/d1/)

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0  
**æœ€åæ›´æ–°**: 2024-12-03  
**ç»´æŠ¤è€…**: AI Prompts Mini Team
